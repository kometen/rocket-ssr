async function handleRegisterClick(e){e.preventDefault();var alias=document.getElementById("alias").value,username=document.getElementById("username").value,p=(Status("Starting registering..."),new Passwordless.Client({apiUrl:API_URL,apiKey:API_KEY})),username={userId:self.crypto.randomUUID(),username:username,alias:alias},alias=await fetch("/passwordless/api/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(username)});if(!alias.ok)throw username=await alias.json(),new Error(username.error||"Registration failed");username=await alias.json();console.log("Registration successful:",username);try{var{token,error}=await p.register(username.token);token?Status("Successfully registered WebAuthn. You can now sign in!"):(Status(JSON.stringify(error,null,2)),Status("We failed to register a passkey: "))}catch(e){console.error("Things went bad",e),Status("Things went bad, check console")}}document.getElementById("passwordless-register").addEventListener("click",handleRegisterClick);
